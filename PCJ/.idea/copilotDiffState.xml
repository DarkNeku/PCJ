<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/SCENE/PokemonCardGrande.tscn">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCENE/PokemonCardGrande.tscn" />
              <option name="originalContent" value="[gd_scene load_steps=2 format=3 uid=&quot;uid://cmfnyg0got4y&quot;]&#10;&#10;[ext_resource type=&quot;Script&quot; uid=&quot;uid://uwftg3g8aee5&quot; path=&quot;res://SCRIPT/PokemonCardGrande.gd&quot; id=&quot;1_d3rg1&quot;]&#10;&#10;[node name=&quot;PokemonCard&quot; type=&quot;VBoxContainer&quot;]&#10;custom_minimum_size = Vector2(240, 280)&#10;anchors_preset = 15&#10;anchor_right = 1.0&#10;anchor_bottom = 1.0&#10;grow_horizontal = 2&#10;grow_vertical = 2&#10;size_flags_horizontal = 3&#10;size_flags_vertical = 3&#10;mouse_filter = 2&#10;script = ExtResource(&quot;1_d3rg1&quot;)&#10;&#10;[node name=&quot;ImagenContainer&quot; type=&quot;Control&quot; parent=&quot;.&quot;]&#10;custom_minimum_size = Vector2(535, 550)&#10;layout_mode = 2&#10;mouse_filter = 1&#10;&#10;[node name=&quot;TextureRect&quot; type=&quot;TextureRect&quot; parent=&quot;ImagenContainer&quot;]&#10;custom_minimum_size = Vector2(0, 550)&#10;layout_mode = 0&#10;anchor_right = 1.0&#10;anchor_bottom = 1.0&#10;expand_mode = 1&#10;stretch_mode = 5&#10;&#10;[node name=&quot;BARRAS&quot; type=&quot;HBoxContainer&quot; parent=&quot;.&quot;]&#10;visible = false&#10;layout_mode = 2&#10;size_flags_horizontal = 4&#10;&#10;[node name=&quot;SALUD&quot; type=&quot;HBoxContainer&quot; parent=&quot;BARRAS&quot;]&#10;custom_minimum_size = Vector2(0, 30)&#10;layout_mode = 2&#10;size_flags_horizontal = 0&#10;&#10;[node name=&quot;PS&quot; type=&quot;Label&quot; parent=&quot;BARRAS/SALUD&quot;]&#10;custom_minimum_size = Vector2(20, 0)&#10;layout_mode = 2&#10;mouse_filter = 1&#10;theme_override_font_sizes/font_size = 80&#10;text = &quot;PS&quot;&#10;&#10;[node name=&quot;SEPARACION&quot; type=&quot;Label&quot; parent=&quot;BARRAS/SALUD&quot;]&#10;layout_mode = 2&#10;text = &quot;/&quot;&#10;&#10;[node name=&quot;PS_MAX&quot; type=&quot;Label&quot; parent=&quot;BARRAS/SALUD&quot;]&#10;layout_mode = 2&#10;&#10;[node name=&quot;Control&quot; type=&quot;HBoxContainer&quot; parent=&quot;BARRAS&quot;]&#10;custom_minimum_size = Vector2(30, 0)&#10;layout_mode = 2&#10;size_flags_horizontal = 6&#10;&#10;[node name=&quot;EXPERIENCIA&quot; type=&quot;HBoxContainer&quot; parent=&quot;BARRAS&quot;]&#10;custom_minimum_size = Vector2(0, 30)&#10;layout_mode = 2&#10;&#10;[node name=&quot;EXP&quot; type=&quot;Label&quot; parent=&quot;BARRAS/EXPERIENCIA&quot;]&#10;custom_minimum_size = Vector2(20, 0)&#10;layout_mode = 2&#10;mouse_filter = 1&#10;text = &quot;EXP&quot;&#10;&#10;[node name=&quot;Panel&quot; type=&quot;Panel&quot; parent=&quot;.&quot;]&#10;custom_minimum_size = Vector2(0, 360)&#10;layout_mode = 2&#10;&#10;[node name=&quot;PanelDatos&quot; type=&quot;HBoxContainer&quot; parent=&quot;Panel&quot;]&#10;custom_minimum_size = Vector2(0, 60)&#10;layout_mode = 2&#10;offset_top = 85.0&#10;offset_right = 1080.0&#10;offset_bottom = 263.0&#10;size_flags_horizontal = 3&#10;&#10;[node name=&quot;PSLabel&quot; type=&quot;Label&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;layout_mode = 2&#10;theme_override_font_sizes/font_size = 32&#10;text = &quot;PS   &quot;&#10;&#10;[node name=&quot;PSSpin&quot; type=&quot;SpinBox&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;custom_minimum_size = Vector2(150, 40)&#10;layout_mode = 2&#10;max_value = 999.0&#10;&#10;[node name=&quot;ExpSeparador&quot; type=&quot;Control&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;custom_minimum_size = Vector2(30, 40)&#10;layout_mode = 2&#10;layout_mode = 2&#10;custom_minimum_size = Vector2(150, 0)&#10;layout_mode = 2&#10;" />
              <option name="updatedContent" value="[gd_scene load_steps=2 format=3 uid=&quot;uid://cmfnyg0got4y&quot;]&#10;&#10;[ext_resource type=&quot;Script&quot; uid=&quot;uid://uwftg3g8aee5&quot; path=&quot;res://SCRIPT/PokemonCardGrande.gd&quot; id=&quot;1_d3rg1&quot;]&#10;&#10;[node name=&quot;PokemonCard&quot; type=&quot;VBoxContainer&quot;]&#10;custom_minimum_size = Vector2(240, 280)&#10;anchors_preset = 15&#10;anchor_right = 1.0&#10;anchor_bottom = 1.0&#10;grow_horizontal = 2&#10;grow_vertical = 2&#10;size_flags_horizontal = 3&#10;size_flags_vertical = 3&#10;mouse_filter = 2&#10;script = ExtResource(&quot;1_d3rg1&quot;)&#10;&#10;[node name=&quot;ImagenContainer&quot; type=&quot;Control&quot; parent=&quot;.&quot;]&#10;custom_minimum_size = Vector2(535, 550)&#10;layout_mode = 2&#10;mouse_filter = 1&#10;&#10;[node name=&quot;TextureRect&quot; type=&quot;TextureRect&quot; parent=&quot;ImagenContainer&quot;]&#10;custom_minimum_size = Vector2(0, 550)&#10;layout_mode = 0&#10;anchor_right = 1.0&#10;anchor_bottom = 1.0&#10;expand_mode = 1&#10;stretch_mode = 5&#10;&#10;[node name=&quot;BARRAS&quot; type=&quot;HBoxContainer&quot; parent=&quot;.&quot;]&#10;visible = false&#10;layout_mode = 2&#10;size_flags_horizontal = 4&#10;&#10;[node name=&quot;SALUD&quot; type=&quot;HBoxContainer&quot; parent=&quot;BARRAS&quot;]&#10;custom_minimum_size = Vector2(0, 30)&#10;layout_mode = 2&#10;size_flags_horizontal = 0&#10;&#10;[node name=&quot;PS&quot; type=&quot;Label&quot; parent=&quot;BARRAS/SALUD&quot;]&#10;custom_minimum_size = Vector2(20, 0)&#10;layout_mode = 2&#10;mouse_filter = 1&#10;theme_override_font_sizes/font_size = 80&#10;text = &quot;PS&quot;&#10;&#10;[node name=&quot;SEPARACION&quot; type=&quot;Label&quot; parent=&quot;BARRAS/SALUD&quot;]&#10;layout_mode = 2&#10;text = &quot;/&quot;&#10;&#10;[node name=&quot;PS_MAX&quot; type=&quot;Label&quot; parent=&quot;BARRAS/SALUD&quot;]&#10;layout_mode = 2&#10;&#10;[node name=&quot;Control&quot; type=&quot;HBoxContainer&quot; parent=&quot;BARRAS&quot;]&#10;custom_minimum_size = Vector2(30, 0)&#10;layout_mode = 2&#10;size_flags_horizontal = 6&#10;&#10;[node name=&quot;EXPERIENCIA&quot; type=&quot;HBoxContainer&quot; parent=&quot;BARRAS&quot;]&#10;custom_minimum_size = Vector2(0, 30)&#10;layout_mode = 2&#10;&#10;[node name=&quot;EXP&quot; type=&quot;Label&quot; parent=&quot;BARRAS/EXPERIENCIA&quot;]&#10;custom_minimum_size = Vector2(20, 0)&#10;layout_mode = 2&#10;mouse_filter = 1&#10;text = &quot;EXP&quot;&#10;&#10;[node name=&quot;Panel&quot; type=&quot;Panel&quot; parent=&quot;.&quot;]&#10;custom_minimum_size = Vector2(0, 360)&#10;layout_mode = 2&#10;&#10;[node name=&quot;PanelDatos&quot; type=&quot;HBoxContainer&quot; parent=&quot;Panel&quot;]&#10;custom_minimum_size = Vector2(0, 60)&#10;layout_mode = 2&#10;offset_top = 85.0&#10;offset_right = 1080.0&#10;offset_bottom = 263.0&#10;size_flags_horizontal = 3&#10;&#10;[node name=&quot;PSLabel&quot; type=&quot;Label&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;layout_mode = 2&#10;theme_override_font_sizes/font_size = 32&#10;text = &quot;PS   &quot;&#10;&#10;[node name=&quot;PSSpin&quot; type=&quot;SpinBox&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;custom_minimum_size = Vector2(150, 40)&#10;layout_mode = 2&#10;max_value = 999.0&#10;theme_override_font_sizes/font_size = 60&#10;&#10;[node name=&quot;PS_ACTUAL&quot; type=&quot;Label&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;layout_mode = 2&#10;&#10;[node name=&quot;ExpSeparador&quot; type=&quot;Control&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;custom_minimum_size = Vector2(30, 40)&#10;layout_mode = 2&#10;&#10;[node name=&quot;EXPLabel&quot; type=&quot;Label&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;layout_mode = 2&#10;theme_override_font_sizes/font_size = 32&#10;text = &quot;EXP   &quot;&#10;&#10;[node name=&quot;EXPSpin&quot; type=&quot;SpinBox&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;custom_minimum_size = Vector2(150, 0)&#10;layout_mode = 2&#10;max_value = 999.0&#10;theme_override_font_sizes/font_size = 60&#10;&#10;[node name=&quot;EXP_ACTUAL&quot; type=&quot;Label&quot; parent=&quot;Panel/PanelDatos&quot;]&#10;layout_mode = 2" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SCRIPT/PANELES.gd">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCRIPT/PANELES.gd" />
              <option name="originalContent" value="extends Node2D&#10;&#10;&#10;&#9;btn_captura.pressed.connect(func(): mostrar_seccion(&quot;captura&quot;))&#10;&#9;dialogo_confirmacion = $CONFIRMACION&#10;&#9;if barra_busqueda:&#10;&#9;&#9;barra_busqueda.text_changed.connect(_on_busqueda_text_changed)&#10;&#9;if busquedaPC:&#10;&#9;&#9;busquedaPC.text_changed.connect(_on_busquedaPC_text_changed)&#10;&#9;lista_equipo.id_pressed.connect(_on_ListaEquipo_id_pressed)&#10;&#10;func mostrar_seccion(seccion):&#10;&#9;panel_equipo.visible = (seccion == &quot;equipo&quot;)&#10;&#9;panel_pc.visible = (seccion == &quot;pc&quot;)&#10;&#9;panel_captura.visible = (seccion == &quot;captura&quot;)&#10;&#9;# Para que el panel visible se muestre arriba, lo movemos al inicio del VBoxContainer&#10;&#9;if seccion == &quot;equipo&quot;:&#10;&#9;&#9;move_child(panel_equipo, 0)&#10;&#9;&#9;mostrar_tarjetas_equipo()&#10;&#9;elif seccion == &quot;pc&quot;:&#10;&#9;&#9;move_child(panel_pc, 0)&#10;&#9;&#9;mostrar_tarjetas_pc()&#10;&#9;elif seccion == &quot;captura&quot;:&#10;func _on_busqueda_text_changed(nuevo_texto):&#10;&#9;filtro_busqueda = nuevo_texto&#10;&#9;mostrar_tarjetas_captura()&#10;&#10;func _on_busquedaPC_text_changed(nuevo_texto):&#10;&#9;filtro_busqueda_pc = nuevo_texto&#10;&#9;mostrar_tarjetas_pc()&#10;&#10;func mostrar_tarjetas_captura():&#10;&#9;# Eliminar todos los hijos del GridContainer manualmente&#10;&#9;for child in grid_captura.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#9;# Configurar columnas del GridContainer (por si acaso)&#10;&#9;if grid_captura.has_method(&quot;set_columns&quot;):&#10;&#9;&#9;grid_captura.set_columns(2)&#10;&#9;# Leer el JSON de la base de datos de Pokémon&#10;&#9;var pokedex_json = FileAccess.open(&quot;res://SCRIPT/POKEMON_DB.json&quot;, FileAccess.READ)&#10;&#9;if pokedex_json:&#10;&#9;&#9;var data = pokedex_json.get_as_text()&#10;&#9;&#9;pokemons_db = []&#10;&#9;&#9;&#9;pokemons_db = JSON.parse_string(data)&#10;&#9;&#9;if typeof(pokemons_db) == TYPE_ARRAY:&#10;&#9;&#9;&#9;pokemons_db.sort_custom(func(a, b): return int(a[&quot;id&quot;]) &lt; int(b[&quot;id&quot;]))&#10;&#9;&#9;&#9;for poke in pokemons_db:&#10;&#9;&#9;&#9;&#9;&#9;&#9;var imagen_path = poke.get(&quot;img_link&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;&#9;var ps = poke.get(&quot;ps_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;&#9;if ps == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;ps = poke.get(&quot;ps_max&quot;, 0)&#10;&#9;&#9;&#9;&#9;&#9;&#9;ps = int(ps)&#10;&#9;&#9;&#9;&#9;&#9;&#9;var ps_max = int(poke.get(&quot;ps_max&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;&#9;var exp = poke.get(&quot;exp_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;&#9;var atrapado = int(poke.get(&quot;atrapado&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;&#9;var id_poke = poke.get(&quot;id&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;&#9;# En cada llamada a configurar, agrega el parámetro nombre&#10;&#9;&#9;&#9;&#9;&#9;&#9;tarjeta.call_deferred(&quot;configurar&quot;, imagen_path, ps, ps_max, exp, exp_max, atrapado, true, poke.get(&quot;nombre&quot;, &quot;&quot;))&#10;&#9;&#9;&#9;&#9;&#9;&#9;tarjeta.connect(&quot;tarjeta_presionada&quot;, Callable(self, &quot;mostrar_confirmacion&quot;).bind(id_poke, poke.get(&quot;nombre&quot;, &quot;&quot;)))&#10;&#9;&#9;&#9;&#9;&#9;&#9;grid_captura.add_child(tarjeta)&#10;&#9;else:&#10;&#9;&#9;print(&quot;No se pudo abrir el archivo POKEMON_DB.json&quot;)&#10;&#10;func mostrar_tarjetas_pc():&#10;&#9;# Eliminar todos los hijos del GridContainer manualmente&#10;&#9;for child in grid_pc.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#9;# Configurar columnas del GridContainer (por si acaso)&#10;&#9;if grid_pc.has_method(&quot;set_columns&quot;):&#10;&#9;&#9;var pokemons = []&#10;&#9;var pokedex_path = &quot;res://ASSET/POKEDEX/&quot;&#10;&#9;var dir = DirAccess.open(pokedex_path)&#10;&#9;var archivos = []&#10;&#9;if dir:&#10;&#9;&#9;dir.list_dir_begin()&#10;&#9;&#9;var file_name = dir.get_next()&#10;&#10;&#10;&#10;&#10;@onready var grid_captura = $PanelCaptura/ScrollContainer/GridContainer&#10;&#9;mostrar_seccion(&quot;equipo&quot;)&#10;&#9;btn_pc.pressed.connect(func(): mostrar_seccion(&quot;pc&quot;))&#10;&#9;panel_captura.visible = (seccion == &quot;captura&quot;)&#10;&#9;&#9;move_child(panel_pc, 0)&#10;&#9;&#9;&#9;&#9;&#9;&#9;tarjeta.connect(&quot;tarjeta_presionada&quot;, Callable(self, &quot;mostrar_confirmacion_pc&quot;).bind(poke.get(&quot;id&quot;, &quot;&quot;), poke.get(&quot;nombre&quot;, &quot;&quot;)))&#10;&#9;&#9;&#9;&#9;&#9;&#9;grid_pc.add_child(tarjeta)&#10;&#9;else:&#10;&#9;&#9;print(&quot;No se pudo abrir el archivo POKEMON_DB.json&quot;)&#10;&#10;func mostrar_confirmacion(id_pokemon, nombre_pokemon):&#10;&#9;id_pokemon_seleccionado = id_pokemon&#10;&#9;nombre_pokemon_seleccionado = nombre_pokemon&#10;&#9;confirmacion.dialog_text = &quot;\n¿CAPTURASTE A %s?\n&quot; % nombre_pokemon&#10;&#10;func mostrar_confirmacion_pc(id_pokemon, nombre_pokemon):&#10;&#9;id_pokemon_seleccionado = id_pokemon&#10;&#9;nombre_pokemon_seleccionado = nombre_pokemon&#10;&#9;var mensaje = &quot;\n¿QUIERES MOVER A\n%s AL EQUIPO?\n&quot; % nombre_pokemon&#10;&#9;confirmacion.dialog_text = mensaje&#10;&#9;if confirmacion.visible:&#10;&#9;&#9;confirmacion.hide()&#10;&#9;lista_equipo.clear()&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;# Leer la base de datos&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;var id_pc = id_pokemon_seleccionado&#10;&#9;var idx_pc = -1&#10;&#9;var idx_eq = -1&#10;&#9;for i in range(pokemons_db_local.size()):&#10;&#9;&#9;var poke = pokemons_db_local[i]&#10;&#9;&#9;if poke.get(&quot;id&quot;, &quot;&quot;) == id_pc:&#10;&#9;var pokedex_json = FileAccess.open(&quot;res://SCRIPT/POKEMON_DB.json&quot;, FileAccess.READ)&#10;&#9;var pokemons_db_local = []&#10;&#9;if pokedex_json:&#10;&#9;&#9;var data = pokedex_json.get_as_text()&#10;&#9;&#9;if data:&#10;&#9;&#9;&#9;pokemons_db_local = JSON.parse_string(data)&#10;&#9;# Buscar el Pokémon del PC y el del equipo&#10;&#9;&#9;if int(poke.get(&quot;equipo&quot;, 0)) == num_equipo:&#10;&#9;&#9;&#9;idx_eq = i&#10;&#9;# Intercambiar los valores de 'equipo'&#10;&#9;if idx_pc != -1 and idx_eq != -1:&#10;&#9;&#9;var temp = pokemons_db_local[idx_eq][&quot;equipo&quot;]&#10;&#9;&#9;pokemons_db_local[idx_eq][&quot;equipo&quot;] = 0&#10;&#9;&#9;pokemons_db_local[idx_pc][&quot;equipo&quot;] = temp&#10;&#9;&#9;pokemons_db_local[idx_pc][&quot;ubicacion&quot;] = &quot;equipo&quot;&#10;&#9;&#9;pokemons_db_local[idx_eq][&quot;ubicacion&quot;] = &quot;pc&quot;&#10;&#9;&#9;# Guardar el JSON actualizado&#10;&#9;&#9;guardar_json(pokemons_db_local)&#10;&#9;&#9;# Refrescar las vistas&#10;&#9;&#9;mostrar_tarjetas_pc()&#10;&#9;&#9;mostrar_tarjetas_equipo()&#10;&#9;lista_equipo.hide()&#10;&#10;func cargar_json():&#10;&#9;&#9;json_utils.save_pretty_json(&quot;res://SCRIPT/POKEMON_DB.json&quot;, pokemons_db_local)&#10;&#9;if file == null:&#10;&#9;&#9;# Si no existe en user://, copiar desde res://&#10;&#9;&#9;var res_file = FileAccess.open(JSON_PATH_RES, FileAccess.READ)&#10;&#9;&#9;if res_file:&#10;&#9;&#9;&#9;var data = res_file.get_as_text()&#10;&#10;&#10;&#10;&#10;&#10;&#10;&#10;" />
              <option name="updatedContent" value="extends VBoxContainer&#10;&#10;# Referencias a los paneles y barra de navegación&#10;@onready var panel_equipo = $PanelEquipo&#10;@onready var panel_pc = $PanelPC&#10;@onready var panel_captura = $PanelCaptura&#10;@onready var barra_navegacion = $BarraNavegacion&#10;@onready var btn_equipo = $BarraNavegacion/BtnEquipo&#10;@onready var btn_pc = $BarraNavegacion/BtnPC&#10;@onready var btn_captura = $BarraNavegacion/BtnCaptura&#10;@onready var scroll_captura = $PanelCaptura/ScrollContainer&#10;@onready var grid_captura = $PanelCaptura/ScrollContainer/GridContainer&#10;@onready var confirmacion = $CONFIRMACION&#10;@onready var barra_busqueda = $PanelCaptura/BarraBusqueda&#10;@onready var grid_pc = $PanelPC/ScrollContainer/GridContainer&#10;@onready var busquedaPC = $PanelPC/busquedaPC&#10;@onready var grid_equipo = $PanelEquipo/Panel/GridContainer&#10;@onready var lista_equipo = $ListaEquipo&#10;@onready var popup_tarjeta = $PopupTarjetaPokemon&#10;@onready var contenedor_tarjeta = $PopupTarjetaPokemon/ContenedorTarjeta&#10;@onready var btn_cerrar_popup = $PopupTarjetaPokemon/BtnCerrarPopup&#10;@onready var btn_guardar_popup = $PopupTarjetaPokemon/BTNGUARDARPOPUP&#10;&#10;const JSON_PATH_RES = &quot;res://SCRIPT/POKEMON_DB.json&quot;&#10;const JSON_PATH_USER = &quot;user://POKEMON_DB.json&quot;&#10;&#10;var dialogo_confirmacion&#10;var nombre_pokemon_seleccionado = &quot;&quot;&#10;var id_pokemon_seleccionado = &quot;&quot;&#10;var filtro_busqueda = &quot;&quot;&#10;var filtro_busqueda_pc = &quot;&quot;&#10;var pokemons_db = []&#10;var json_utils = preload(&quot;res://SCRIPT/json_utils.gd&quot;).new()&#10;&#10;func _ready():&#10;&#9;mostrar_seccion(&quot;equipo&quot;)&#10;&#9;btn_equipo.pressed.connect(func(): mostrar_seccion(&quot;equipo&quot;))&#10;&#9;btn_pc.pressed.connect(func(): mostrar_seccion(&quot;pc&quot;))&#10;&#9;btn_captura.pressed.connect(func(): mostrar_seccion(&quot;captura&quot;))&#10;&#9;dialogo_confirmacion = $CONFIRMACION&#10;&#9;if barra_busqueda:&#10;&#9;&#9;barra_busqueda.text_changed.connect(_on_busqueda_text_changed)&#10;&#9;if busquedaPC:&#10;&#9;&#9;busquedaPC.text_changed.connect(_on_busquedaPC_text_changed)&#10;&#9;lista_equipo.id_pressed.connect(_on_ListaEquipo_id_pressed)&#10;&#9;btn_cerrar_popup.pressed.connect(func(): cerrar_popup_tarjeta())&#10;&#9;btn_guardar_popup.pressed.connect(_on_btn_guardar_popup_pressed)&#10;&#10;func mostrar_seccion(seccion):&#10;&#9;panel_equipo.visible = (seccion == &quot;equipo&quot;)&#10;&#9;panel_pc.visible = (seccion == &quot;pc&quot;)&#10;&#9;panel_captura.visible = (seccion == &quot;captura&quot;)&#10;&#9;# Para que el panel visible se muestre arriba, lo movemos al inicio del VBoxContainer&#10;&#9;if seccion == &quot;equipo&quot;:&#10;&#9;&#9;move_child(panel_equipo, 0)&#10;&#9;&#9;mostrar_tarjetas_equipo()&#10;&#9;elif seccion == &quot;pc&quot;:&#10;&#9;&#9;move_child(panel_pc, 0)&#10;&#9;&#9;mostrar_tarjetas_pc()&#10;&#9;elif seccion == &quot;captura&quot;:&#10;&#9;&#9;move_child(panel_captura, 0)&#10;&#9;&#9;mostrar_tarjetas_captura()&#10;&#10;func _on_busqueda_text_changed(nuevo_texto):&#10;&#9;filtro_busqueda = nuevo_texto&#10;&#9;mostrar_tarjetas_captura()&#10;&#10;func _on_busquedaPC_text_changed(nuevo_texto):&#10;&#9;filtro_busqueda_pc = nuevo_texto&#10;&#9;mostrar_tarjetas_pc()&#10;&#10;func mostrar_tarjetas_captura():&#10;&#9;# Eliminar todos los hijos del GridContainer manualmente&#10;&#9;for child in grid_captura.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#9;# Configurar columnas del GridContainer (por si acaso)&#10;&#9;if grid_captura.has_method(&quot;set_columns&quot;):&#10;&#9;&#9;grid_captura.set_columns(2)&#10;&#9;pokemons_db = cargar_json()&#10;&#9;if typeof(pokemons_db) == TYPE_ARRAY:&#10;&#9;&#9;pokemons_db.sort_custom(func(a, b): return int(a[&quot;id&quot;]) &lt; int(b[&quot;id&quot;]))&#10;&#9;&#9;for poke in pokemons_db:&#10;&#9;&#9;&#9;if filtro_busqueda == &quot;&quot; or poke.get(&quot;nombre&quot;, &quot;&quot;).to_lower().find(filtro_busqueda.to_lower()) != -1:&#10;&#9;&#9;&#9;&#9;var tarjeta_escena = load(&quot;res://SCENE/PokemonCard.tscn&quot;)&#10;&#9;&#9;&#9;&#9;if tarjeta_escena:&#10;&#9;&#9;&#9;&#9;&#9;var tarjeta = tarjeta_escena.instantiate()&#10;&#9;&#9;&#9;&#9;&#9;var imagen_path = poke.get(&quot;img_link&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;var ps = poke.get(&quot;ps_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;if ps == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;ps = poke.get(&quot;ps_max&quot;, 0)&#10;&#9;&#9;&#9;&#9;&#9;ps = int(ps)&#10;&#9;&#9;&#9;&#9;&#9;var ps_max = int(poke.get(&quot;ps_max&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var exp = poke.get(&quot;exp_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;if exp == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;exp = 0&#10;&#9;&#9;&#9;&#9;&#9;exp = int(exp)&#10;&#9;&#9;&#9;&#9;&#9;var exp_max = int(poke.get(&quot;exp_evo&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var atrapado = int(poke.get(&quot;atrapado&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var id_poke = poke.get(&quot;id&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;# En captura, mostrar_sello = true&#10;&#9;&#9;&#9;&#9;&#9;tarjeta.call_deferred(&quot;configurar&quot;, imagen_path, ps, ps_max, exp, exp_max, atrapado, true, poke.get(&quot;nombre&quot;, &quot;&quot;), false)&#10;&#9;&#9;&#9;&#9;&#9;tarjeta.connect(&quot;tarjeta_presionada&quot;, Callable(self, &quot;mostrar_confirmacion&quot;).bind(id_poke, poke.get(&quot;nombre&quot;, &quot;&quot;)))&#10;&#9;&#9;&#9;&#9;&#9;grid_captura.add_child(tarjeta)&#10;&#10;func mostrar_tarjetas_pc():&#10;&#9;# Eliminar todos los hijos del GridContainer manualmente&#10;&#9;for child in grid_pc.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#9;# Configurar columnas del GridContainer (por si acaso)&#10;&#9;if grid_pc.has_method(&quot;set_columns&quot;):&#10;&#9;&#9;grid_pc.set_columns(2)&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;if typeof(pokemons_db_local) == TYPE_ARRAY:&#10;&#9;&#9;pokemons_db_local.sort_custom(func(a, b): return int(a[&quot;id&quot;]) &lt; int(b[&quot;id&quot;]))&#10;&#9;&#9;for poke in pokemons_db_local:&#10;&#9;&#9;&#9;if int(poke.get(&quot;atrapado&quot;, 0)) == 1 and int(poke.get(&quot;equipo&quot;, 0)) == 0 and (filtro_busqueda_pc == &quot;&quot; or poke.get(&quot;nombre&quot;, &quot;&quot;).to_lower().find(filtro_busqueda_pc.to_lower()) != -1):&#10;&#9;&#9;&#9;&#9;var tarjeta_escena = load(&quot;res://SCENE/PokemonCard.tscn&quot;)&#10;&#9;&#9;&#9;&#9;if tarjeta_escena:&#10;&#9;&#9;&#9;&#9;&#9;var tarjeta = tarjeta_escena.instantiate()&#10;&#9;&#9;&#9;&#9;&#9;var imagen_path = poke.get(&quot;img_link&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;var ps = poke.get(&quot;ps_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;if ps == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;ps = poke.get(&quot;ps_max&quot;, 0)&#10;&#9;&#9;&#9;&#9;&#9;ps = int(ps)&#10;&#9;&#9;&#9;&#9;&#9;var ps_max = int(poke.get(&quot;ps_max&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var exp = poke.get(&quot;exp_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;if exp == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;exp = 0&#10;&#9;&#9;&#9;&#9;&#9;exp = int(exp)&#10;&#9;&#9;&#9;&#9;&#9;var exp_max = int(poke.get(&quot;exp_evo&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var atrapado = int(poke.get(&quot;atrapado&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;# En cada llamada a configurar, agrega el parámetro nombre&#10;&#9;&#9;&#9;&#9;&#9;# En PC, mostrar_sello = false, mostrar_barras = true, es_pc = true&#10;&#9;&#9;&#9;&#9;&#9;tarjeta.call_deferred(&quot;configurar&quot;, imagen_path, ps, ps_max, exp, exp_max, atrapado, false, poke.get(&quot;nombre&quot;, &quot;&quot;), true, true)&#10;&#9;&#9;&#9;&#9;&#9;tarjeta.connect(&quot;tarjeta_presionada&quot;, Callable(self, &quot;mostrar_confirmacion_pc&quot;).bind(poke.get(&quot;id&quot;, &quot;&quot;), poke.get(&quot;nombre&quot;, &quot;&quot;)))&#10;&#9;&#9;&#9;&#9;&#9;grid_pc.add_child(tarjeta)&#10;&#10;func mostrar_tarjetas_equipo():&#10;&#9;# Eliminar todos los hijos del GridContainer manualmente&#10;&#9;for child in grid_equipo.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#9;# Configurar columnas del GridContainer (por si acaso)&#10;&#9;if grid_equipo.has_method(&quot;set_columns&quot;):&#10;&#9;&#9;grid_equipo.set_columns(2)&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;if typeof(pokemons_db_local) == TYPE_ARRAY:&#10;&#9;&#9;pokemons_db_local.sort_custom(func(a, b): return int(a[&quot;equipo&quot;]) &lt; int(b[&quot;equipo&quot;]))&#10;&#9;&#9;for poke in pokemons_db_local:&#10;&#9;&#9;&#9;var eq = int(poke.get(&quot;equipo&quot;, 0))&#10;&#9;&#9;&#9;if eq &gt; 0 and eq &lt;= 6:&#10;&#9;&#9;&#9;&#9;var tarjeta_escena = load(&quot;res://SCENE/PokemonCard.tscn&quot;)&#10;&#9;&#9;&#9;&#9;if tarjeta_escena:&#10;&#9;&#9;&#9;&#9;&#9;var tarjeta = tarjeta_escena.instantiate()&#10;&#9;&#9;&#9;&#9;&#9;var imagen_path = poke.get(&quot;img_link&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;var ps = poke.get(&quot;ps_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;if ps == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;ps = poke.get(&quot;ps_max&quot;, 0)&#10;&#9;&#9;&#9;&#9;&#9;ps = int(ps)&#10;&#9;&#9;&#9;&#9;&#9;var ps_max = int(poke.get(&quot;ps_max&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var exp = poke.get(&quot;exp_actual&quot;, &quot;&quot;)&#10;&#9;&#9;&#9;&#9;&#9;if exp == &quot;&quot;:&#10;&#9;&#9;&#9;&#9;&#9;&#9;exp = 0&#10;&#9;&#9;&#9;&#9;&#9;exp = int(exp)&#10;&#9;&#9;&#9;&#9;&#9;var exp_max = int(poke.get(&quot;exp_evo&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;var atrapado = int(poke.get(&quot;atrapado&quot;, 0))&#10;&#9;&#9;&#9;&#9;&#9;# En equipo, mostrar_sello = false&#10;&#9;&#9;&#9;&#9;&#9;tarjeta.call_deferred(&quot;configurar&quot;, imagen_path, ps, ps_max, exp, exp_max, atrapado, false, poke.get(&quot;nombre&quot;, &quot;&quot;), true)&#10;&#9;&#9;&#9;&#9;&#9;tarjeta.connect(&quot;tarjeta_presionada&quot;, Callable(self, &quot;mostrar_popup_tarjeta_equipo&quot;).bind(poke))&#10;&#9;&#9;&#9;&#9;&#9;grid_equipo.add_child(tarjeta)&#10;&#10;func mostrar_popup_tarjeta_equipo(poke):&#10;&#9;# Cerrar cualquier ventana modal abierta&#10;&#9;if confirmacion.visible:&#10;&#9;&#9;confirmacion.hide()&#10;&#9;popup_tarjeta.hide()&#10;&#9;# Limpiar el contenedor del popup&#10;&#9;for child in contenedor_tarjeta.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#9;# Instanciar la tarjeta grande y configurarla con la imagen del Pokémon&#10;&#9;var tarjeta_escena = load(&quot;res://SCENE/PokemonCardGrande.tscn&quot;)&#10;&#9;if tarjeta_escena:&#10;&#9;&#9;var tarjeta = tarjeta_escena.instantiate()&#10;&#9;&#9;var imagen_path = poke.get(&quot;img_link&quot;, &quot;&quot;)&#10;&#9;&#9;var ps_max = int(poke.get(&quot;ps_max&quot;, 0))&#10;&#9;&#9;var exp_actual = int(poke.get(&quot;exp_actual&quot;, 0))&#10;&#9;&#9;tarjeta.call_deferred(&quot;configurar&quot;, imagen_path, ps_max, exp_actual)&#10;&#9;&#9;contenedor_tarjeta.add_child(tarjeta)&#10;&#9;popup_tarjeta.popup_centered()&#10;&#10;func cerrar_popup_tarjeta():&#10;&#9;popup_tarjeta.hide()&#10;&#9;for child in contenedor_tarjeta.get_children():&#10;&#9;&#9;child.queue_free()&#10;&#10;func mostrar_confirmacion(id_pokemon, nombre_pokemon):&#10;&#9;id_pokemon_seleccionado = id_pokemon&#10;&#9;nombre_pokemon_seleccionado = nombre_pokemon&#10;&#9;confirmacion.dialog_text = &quot;\n¿CAPTURASTE A %s?\n&quot; % nombre_pokemon&#10;&#9;if confirmacion.visible:&#10;&#9;&#9;confirmacion.hide()&#10;&#9;confirmacion.popup_centered()&#10;&#10;func mostrar_confirmacion_pc(id_pokemon, nombre_pokemon):&#10;&#9;id_pokemon_seleccionado = id_pokemon&#10;&#9;nombre_pokemon_seleccionado = nombre_pokemon&#10;&#9;var mensaje = &quot;\n¿QUIERES MOVER A\n%s AL EQUIPO?\n&quot; % nombre_pokemon&#10;&#9;confirmacion.dialog_text = mensaje&#10;&#9;if confirmacion.visible:&#10;&#9;&#9;confirmacion.hide()&#10;&#9;confirmacion.popup_centered()&#10;&#10;func mostrar_lista_equipo():&#10;&#9;lista_equipo.clear()&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;if typeof(pokemons_db_local) == TYPE_ARRAY:&#10;&#9;&#9;for poke in pokemons_db_local:&#10;&#9;&#9;&#9;var eq = int(poke.get(&quot;equipo&quot;, 0))&#10;&#9;&#9;&#9;if eq &gt; 0 and eq &lt;= 6:&#10;&#9;&#9;&#9;&#9;var texto = &quot;%d - %s&quot; % [eq, poke.get(&quot;nombre&quot;, &quot;&quot;)]&#10;&#9;&#9;&#9;&#9;lista_equipo.add_item(texto)&#10;&#9;lista_equipo.popup_centered()&#10;&#10;func _on_confirmation_dialog_confirmed():&#10;&#9;# Si la confirmación viene de PanelPC, mostrar la lista de equipo&#10;&#9;if panel_pc.visible:&#10;&#9;&#9;mostrar_lista_equipo()&#10;&#9;&#9;return&#10;&#9;# Buscar el Pokémon en la base de datos y marcarlo como atrapado usando el id&#10;&#9;for poke in pokemons_db:&#10;&#9;&#9;if poke.get(&quot;id&quot;, &quot;&quot;) == id_pokemon_seleccionado:&#10;&#9;&#9;&#9;poke[&quot;atrapado&quot;] = 1&#10;&#9;&#9;&#9;break&#10;&#9;# Guardar el JSON actualizado (usando JSON.stringify para formato correcto)&#10;&#9;if typeof(pokemons_db) == TYPE_ARRAY:&#10;&#9;&#9;guardar_json(pokemons_db)&#10;&#9;else:&#10;&#9;&#9;print(&quot;Error: pokemons_db no es un array válido&quot;)&#10;&#9;# Refrescar la grilla para mostrar el sello&#10;&#9;mostrar_tarjetas_captura()&#10;&#10;func _on_ListaEquipo_id_pressed(index):&#10;&#9;# Obtener el número de equipo y nombre del Pokémon seleccionado en la lista&#10;&#9;var texto = lista_equipo.get_item_text(index)&#10;&#9;var partes = texto.split(&quot; - &quot;)&#10;&#9;if partes.size() != 2:&#10;&#9;&#9;return&#10;&#9;var num_equipo = int(partes[0])&#10;&#9;var nombre_equipo = partes[1]&#10;&#9;# Leer la base de datos&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;var id_pc = id_pokemon_seleccionado&#10;&#9;var idx_pc = -1&#10;&#9;var idx_eq = -1&#10;&#9;for i in range(pokemons_db_local.size()):&#10;&#9;&#9;var poke = pokemons_db_local[i]&#10;&#9;&#9;if poke.get(&quot;id&quot;, &quot;&quot;) == id_pc:&#10;&#9;&#9;&#9;idx_pc = i&#10;&#9;&#9;if int(poke.get(&quot;equipo&quot;, 0)) == num_equipo:&#10;&#9;&#9;&#9;idx_eq = i&#10;&#9;# Intercambiar los valores de 'equipo'&#10;&#9;if idx_pc != -1 and idx_eq != -1:&#10;&#9;&#9;var temp = pokemons_db_local[idx_eq][&quot;equipo&quot;]&#10;&#9;&#9;pokemons_db_local[idx_eq][&quot;equipo&quot;] = 0&#10;&#9;&#9;pokemons_db_local[idx_pc][&quot;equipo&quot;] = temp&#10;&#9;&#9;pokemons_db_local[idx_pc][&quot;ubicacion&quot;] = &quot;equipo&quot;&#10;&#9;&#9;pokemons_db_local[idx_eq][&quot;ubicacion&quot;] = &quot;pc&quot;&#10;&#9;&#9;# Guardar el JSON actualizado&#10;&#9;&#9;guardar_json(pokemons_db_local)&#10;&#9;&#9;# Refrescar las vistas&#10;&#9;&#9;mostrar_tarjetas_pc()&#10;&#9;&#9;mostrar_tarjetas_equipo()&#10;&#9;lista_equipo.hide()&#10;&#10;func cargar_json():&#10;&#9;var file = FileAccess.open(JSON_PATH_USER, FileAccess.READ)&#10;&#9;if file == null:&#10;&#9;&#9;# Si no existe en user://, copiar desde res://&#10;&#9;&#9;var res_file = FileAccess.open(JSON_PATH_RES, FileAccess.READ)&#10;&#9;&#9;if res_file:&#10;&#9;&#9;&#9;var data = res_file.get_as_text()&#10;&#9;&#9;&#9;res_file.close()&#10;&#9;&#9;&#9;var user_file = FileAccess.open(JSON_PATH_USER, FileAccess.WRITE)&#10;&#9;&#9;&#9;if user_file:&#10;&#9;&#9;&#9;&#9;user_file.store_string(data)&#10;&#9;&#9;&#9;&#9;user_file.close()&#10;&#9;&#9;&#9;&#9;file = FileAccess.open(JSON_PATH_USER, FileAccess.READ)&#10;&#9;if file:&#10;&#9;&#9;var json_text = file.get_as_text()&#10;&#9;&#9;file.close()&#10;&#9;&#9;var json = JSON.parse_string(json_text)&#10;&#9;&#9;if typeof(json) == TYPE_ARRAY:&#10;&#9;&#9;&#9;return json&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;return []&#10;&#9;else:&#10;&#9;&#9;return {}&#10;&#10;func guardar_json(data):&#10;&#9;var file = FileAccess.open(JSON_PATH_USER, FileAccess.WRITE)&#10;&#9;if file:&#10;&#9;&#9;file.store_string(JSON.stringify(data, &quot;\t&quot;))&#10;&#9;&#9;file.close()&#10;&#10;func _on_btn_guardar_popup_pressed():&#10;&#9;# Obtener la tarjeta grande actual&#10;&#9;if contenedor_tarjeta.get_child_count() == 0:&#10;&#9;&#9;return&#10;&#9;var tarjeta = contenedor_tarjeta.get_child(0)&#10;&#9;# Obtener los valores de los LineEdit&#10;&#9;var ps_line = tarjeta.get_node(&quot;HBoxContainer/Panel/PS_LINE&quot;)&#10;&#9;var exp_line = tarjeta.get_node(&quot;HBoxContainer/Panel/EXP_LINE&quot;)&#10;&#9;if not ps_line or not exp_line:&#10;&#9;&#9;return&#10;&#9;var nuevo_ps = int(ps_line.text)&#10;&#9;var nueva_exp = int(exp_line.text)&#10;&#9;# Buscar el Pokémon en la base de datos por id&#10;&#9;var id_poke = null&#10;&#9;if tarjeta.has_method(&quot;get_id&quot;):&#10;&#9;&#9;id_poke = tarjeta.get_id()&#10;&#9;else:&#10;&#9;&#9;# Si no hay método, buscar por imagen o por el id guardado en variable global&#10;&#9;&#9;id_poke = id_pokemon_seleccionado&#10;&#9;if not id_poke:&#10;&#9;&#9;return&#10;&#9;var pokemons_db_local = cargar_json()&#10;&#9;for poke in pokemons_db_local:&#10;&#9;&#9;if poke.get(&quot;id&quot;, &quot;&quot;) == str(id_poke):&#10;&#9;&#9;&#9;poke[&quot;ps_actual&quot;] = str(nuevo_ps)&#10;&#9;&#9;&#9;poke[&quot;exp_actual&quot;] = str(nueva_exp)&#10;&#9;&#9;&#9;break&#10;&#9;guardar_json(pokemons_db_local)&#10;&#9;# Opcional: refrescar la vista&#10;&#9;mostrar_tarjetas_equipo()&#10;&#9;mostrar_tarjetas_pc()&#10;&#9;mostrar_tarjetas_captura()&#10;&#9;popup_tarjeta.hide()" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SCRIPT/PokemonCard.gd">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCRIPT/PokemonCard.gd" />
              <option name="originalContent" value="extends VBoxContainer&#10;&#10;# Referencias a los nodos hijos A&#10;@onready var imagen = $TextureRect&#10;@onready var barra_ps = $BARRAS/SALUD/ProgressBar&#10;@onready var barra_exp = $BARRAS/EXPERIENCIA/ProgressBar&#10;# Función para configurar la tarjeta con los datos del Pokémon&#10;func configurar(ruta_imagen: String, ps_actual: int, ps_maximo: int, exp_actual: int, exp_maximo: int):&#10;func configurar(ruta_imagen: String, ps_actual: int, ps_maximo: int, exp_actual: int, exp_maximo: int):&#10;&#9;if imagen and ResourceLoader.exists(ruta_imagen):&#10;&#9;if imagen and ResourceLoader.exists(ruta_imagen):&#10;&#9;&#9;var textura = load(ruta_imagen)&#10;&#9;&#9;if typeof(textura) == TYPE_OBJECT and textura is Texture2D:&#10;&#9;&#9;&#9;imagen.texture = textura&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;imagen.texture = null&#10;&#9;else:&#10;&#9;&#9;imagen.texture = null&#10;&#9;# Configurar barra de PS&#10;&#9;if barra_ps:&#10;&#9;&#9;barra_ps.max_value = ps_maximo&#10;&#9;&#9;barra_ps.value = ps_actual&#10;&#9;# Configurar barra de EXP&#10;&#9;if barra_exp:&#10;&#9;&#9;barra_exp.max_value = exp_maximo&#10;&#9;&#9;barra_exp.value = exp_actual&#10;&#9;# Mostrar el sello solo si mostrar_sello es true y está atrapado&#10;&#10;func _on_gui_input(event):&#10;&#10;&#10;&#10;&#10;" />
              <option name="updatedContent" value="extends VBoxContainer&#10;&#10;# Referencias a los nodos hijos&#10;@onready var imagen = $ImagenContainer/TextureRect&#10;@onready var barra_ps = $BARRAS/SALUD/ProgressBar&#10;@onready var sello = $ImagenContainer/SELLO&#10;@onready var ps_actual_label = $BARRAS/SALUD/PS_ACTUAL&#10;@onready var ps_max_label = $BARRAS/SALUD/PS_MAX&#10;@onready var exp_actual_label = $BARRAS/EXPERIENCIA/EXP_ACTUAL&#10;&#10;# Señal para detectar el click en la tarjeta&#10;signal tarjeta_presionada&#10;&#10;# Función para configurar la tarjeta con los datos del Pokémon&#10;func configurar(ruta_imagen: String, ps_actual: int, ps_maximo: int, exp_actual: int, exp_maximo: int, atrapado := 0, mostrar_sello := true, nombre := &quot;&quot;, mostrar_barras := true, es_pc := false):&#10;&#9;# Cargar y asignar la imagen solo si el nodo existe y el recurso es válido&#10;&#9;if imagen and ResourceLoader.exists(ruta_imagen):&#10;&#9;&#9;var textura = load(ruta_imagen)&#10;&#9;&#9;if typeof(textura) == TYPE_OBJECT and textura is Texture2D:&#10;&#9;&#9;&#9;imagen.texture = textura&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;imagen.texture = null&#10;&#9;else:&#10;&#9;&#9;imagen.texture = null&#10;&#9;# En PC, ps_actual siempre igual a ps_maximo&#10;&#9;if es_pc:&#10;&#9;&#9;ps_actual = ps_maximo&#10;&#9;# Configurar barra de PS&#10;&#9;if barra_ps:&#10;&#9;&#9;barra_ps.max_value = ps_maximo&#10;&#9;&#9;barra_ps.value = ps_actual&#10;&#9;&#9;barra_ps.visible = mostrar_barras&#10;&#9;&#9;# Cambiar color según porcentaje&#10;&#9;&#9;var porcentaje = float(ps_actual) / float(ps_maximo) * 100.0 if ps_maximo &gt; 0 else 0.0&#10;&#9;&#9;if porcentaje &gt;= 50.0:&#10;&#9;&#9;&#9;barra_ps.add_theme_color_override(&quot;fg&quot;, Color(0, 1, 0)) # Verde&#10;&#9;&#9;elif porcentaje &gt;= 10.0:&#10;&#9;&#9;&#9;barra_ps.add_theme_color_override(&quot;fg&quot;, Color(1, 1, 0)) # Amarillo&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;barra_ps.add_theme_color_override(&quot;fg&quot;, Color(1, 0, 0)) # Rojo&#10;&#9;# Mostrar valores en los labels&#10;&#9;if ps_actual_label:&#10;&#9;&#9;ps_actual_label.text = str(ps_actual)&#10;&#9;if ps_max_label:&#10;&#9;&#9;ps_max_label.text = str(ps_maximo)&#10;&#9;# Mostrar experiencia&#10;&#9;if exp_actual_label:&#10;&#9;&#9;if exp_actual == null:&#10;&#9;&#9;&#9;exp_actual_label.text = &quot;0&quot;&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;exp_actual_label.text = str(exp_actual)&#10;&#9;# Mostrar el sello solo si mostrar_sello es true y está atrapado&#10;&#9;if sello:&#10;&#9;&#9;sello.visible = mostrar_sello and atrapado == 1&#10;&#10;var touch_start_pos = null&#10;var touch_moved = false&#10;const TAP_THRESHOLD = 20 # píxeles&#10;&#10;func _ready():&#10;&#9;# Habilitar la detección de clics en la tarjeta&#10;&#9;self.mouse_filter = Control.MOUSE_FILTER_PASS&#10;&#9;connect(&quot;gui_input&quot;, Callable(self, &quot;_on_gui_input&quot;))&#10;&#10;func _on_gui_input(event):&#10;&#9;if event is InputEventMouseButton:&#10;&#9;&#9;if event.pressed and event.button_index == MOUSE_BUTTON_LEFT:&#10;&#9;&#9;&#9;touch_start_pos = event.position&#10;&#9;&#9;&#9;touch_moved = false&#10;&#9;&#9;elif not event.pressed and event.button_index == MOUSE_BUTTON_LEFT and touch_start_pos != null:&#10;&#9;&#9;&#9;if not touch_moved:&#10;&#9;&#9;&#9;&#9;emit_signal(&quot;tarjeta_presionada&quot;)&#10;&#9;&#9;&#9;touch_start_pos = null&#10;&#9;elif event is InputEventMouseMotion and touch_start_pos != null:&#10;&#9;&#9;if event.position.distance_to(touch_start_pos) &gt; TAP_THRESHOLD:&#10;&#9;&#9;&#9;touch_moved = true" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SCRIPT/PokemonCardGrande.gd">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCRIPT/PokemonCardGrande.gd" />
              <option name="originalContent" value="extends VBoxContainer&#10;&#10;@onready var imagen = $ImagenContainer/TextureRect&#10;&#10;func configurar(ruta_imagen: String):&#10;&#9;if imagen and ResourceLoader.exists(ruta_imagen):&#10;&#9;&#9;var textura = load(ruta_imagen)&#10;&#9;&#9;if typeof(textura) == TYPE_OBJECT and textura is Texture2D:&#10;&#9;&#9;&#9;imagen.texture = textura&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;imagen.texture = null&#10;&#9;else:&#10;&#9;&#9;imagen.texture = null&#10;&#10;&#10;" />
              <option name="updatedContent" value="extends VBoxContainer&#10;&#10;@onready var imagen = $ImagenContainer/TextureRect&#10;@onready var ps_max_label = $HBoxContainer/Panel/PS_MAX # Label para PS máximo&#10;@onready var exp_actual_label = $HBoxContainer/Panel/EXP_ACT # Label para experiencia actual&#10;&#10;func configurar(ruta_imagen: String, ps_max: int, exp_actual: int):&#10;&#9;if imagen and ResourceLoader.exists(ruta_imagen):&#10;&#9;&#9;var textura = load(ruta_imagen)&#10;&#9;&#9;if typeof(textura) == TYPE_OBJECT and textura is Texture2D:&#10;&#9;&#9;&#9;imagen.texture = textura&#10;&#9;&#9;else:&#10;&#9;&#9;&#9;imagen.texture = null&#10;&#9;else:&#10;&#9;&#9;imagen.texture = null&#10;&#9;# Mostrar PS máximo y experiencia actual&#10;&#9;if ps_max_label:&#10;&#9;&#9;ps_max_label.text = str(ps_max)&#10;&#9;if exp_actual_label:&#10;&#9;&#9;exp_actual_label.text = str(exp_actual)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SCRIPT/json_utils.gd">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCRIPT/json_utils.gd" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="# Utilidad para guardar JSON con formato bonito en Godot&#10;extends Node&#10;&#10;# Guarda un array o diccionario en formato JSON bonito (indentado)&#10;func save_pretty_json(path: String, data):&#10;&#9;var file = FileAccess.open(path, FileAccess.WRITE)&#10;&#9;if file:&#10;&#9;&#9;var json_text = JSON.stringify(data, &quot;\t&quot;) # Indentación con tabulación&#10;&#9;&#9;file.store_string(json_text)&#10;&#9;&#9;file.close()&#10;&#9;&#9;return true&#10;&#9;else:&#10;&#9;&#9;return false&#10;&#10;# Ejemplo de uso:&#10;# var data = [{&quot;nombre&quot;: &quot;Bulbasaur&quot;, &quot;numero&quot;: &quot;001&quot;}, ...]&#10;# save_pretty_json(&quot;res://SCRIPT/POKEMON_DB.json&quot;, data)" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>